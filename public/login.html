<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log In</title>
</head>
<body>
    <h1>Log in</h1>
    <a href="/index.html">Home</a>

    <!--Display Result-->
 <div class ="errorMsg"> 
    <p> Username or password is invalid</p>
 </div>

    <form id ="login" name="login"> <!-- TODO: Add username address input -->
         <label for ="username">Enter username</label>
        <input id="username" type="text" name="username" autofocus>
        <!-- TODO: Add password address input -->
        <label for ="password">Enter password</label>
        <input id="password" type="password" name="password" autofocus>
        <!-- TODO: Add submit button -->
        <input type="submit" value="Submit"/>
    </form>

    <script type="text/javascript">

function callApi(data) { let url="/api/login" 
let options = {
    method: "POST",
    headers:{
        "Content-Type":"application/json"
    },
    body:JSON.stringify(data)
}



return fetch(url,options).then
(response => response.json()

)}


//get username and pass to send to the API
let form = document.getElementById("login");
//check to see if login is correct. 

let username =  document.getElementById("username");
let password = document.getElementById("password");



form.addEventListener("submit", (event) => { 
	event.preventDefault();      // stop the sumbit button

//gets url 
function apiGetRequest(url){
    return fetch(url).then(
        response => response.json()
    )
}


let formdata = new FormData(form);
let username  = formdata.get("username");
let password = formdata.get("password"); //send to api

// let LoginError = document.getElementById("LoginError"); //send error msg
//apend it the url 

let data = {
    username: username,
    password: password
}

//username and password
callApi(data).then(response => {
   
    let LoginError = document.getElementById("errorMsg"); //send error msg
    
    console.log(response);
    if(response){  //login correct
    }
    else{
        //output error message 
        LoginError.insertAdjacentHTML("beforeend","<p>Username or password is invalid</p>");
    }
})
})



  



    /*
            TODO: Stop the submit button sending the form >
            TODO: Capture the input values using FormData
            TODO: Send the data to the login API /api/login
            TODO: Check the login is correct agains some hard-coded values, e.g. username="test@test.com", password="password"
         */
    </script>
</body>
</html>